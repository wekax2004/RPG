<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sprite Sheet Inspector</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1e1e1e;
            color: #d4d4d4;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            margin: 0;
        }

        h1 {
            margin-bottom: 20px;
        }

        .controls {
            background-color: #252526;
            padding: 20px;
            border-radius: 8px;
            display: flex;
            gap: 20px;
            align-items: flex-end;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            flex-wrap: wrap;
            justify-content: center;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        label {
            font-size: 14px;
            color: #9cdcfe;
        }

        input[type="number"],
        input[type="file"] {
            background-color: #3c3c3c;
            border: 1px solid #3c3c3c;
            color: white;
            padding: 8px;
            border-radius: 4px;
        }

        input[type="number"] {
            width: 80px;
        }

        .canvas-container {
            border: 2px solid #3c3c3c;
            background-image: linear-gradient(45deg, #2d2d2d 25%, transparent 25%),
                linear-gradient(-45deg, #2d2d2d 25%, transparent 25%),
                linear-gradient(45deg, transparent 75%, #2d2d2d 75%),
                linear-gradient(-45deg, transparent 75%, #2d2d2d 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            max-width: 100%;
            overflow: auto;
            position: relative;
        }

        canvas {
            display: block;
        }

        .info {
            margin-top: 10px;
            color: #ce9178;
            font-size: 14px;
        }
    </style>
</head>

<body>

    <h1>Sprite Sheet Inspector</h1>

    <div class="controls">
        <div class="control-group">
            <label>Upload Image</label>
            <input type="file" id="upload" accept="image/*">
        </div>
        <div class="control-group">
            <label>Tile Size (px)</label>
            <input type="number" id="tileSize" value="64">
        </div>
        <div class="control-group">
            <label>Stride (px)</label>
            <input type="number" id="stride" value="64">
        </div>
        <div class="control-group">
            <label>Offset X (px)</label>
            <input type="number" id="offsetX" value="0">
        </div>
        <div class="control-group">
            <label>Offset Y (px)</label>
            <input type="number" id="offsetY" value="0">
        </div>
    </div>

    <div class="info">Cell 0 (Blue Box) represents the first tile the game will read.</div>

    <div class="canvas-container">
        <canvas id="canvas"></canvas>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const upload = document.getElementById('upload');
        const inputs = ['tileSize', 'stride', 'offsetX', 'offsetY'].map(id => document.getElementById(id));

        let img = new Image();
        let loaded = false;

        // Auto-redraw on any input change
        inputs.forEach(input => input.addEventListener('input', draw));

        upload.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (event) => {
                img = new Image();
                img.onload = () => {
                    loaded = true;
                    // Reset canvas size
                    canvas.width = img.width;
                    canvas.height = img.height;
                    draw();
                };
                img.src = event.target.result;
            };
            reader.readAsDataURL(file);
        });

        function draw() {
            if (!loaded) return;

            // Clear
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Draw Image
            ctx.drawImage(img, 0, 0);

            // Get Config
            const tileSize = parseInt(document.getElementById('tileSize').value) || 32;
            const stride = parseInt(document.getElementById('stride').value) || 32;
            const offX = parseInt(document.getElementById('offsetX').value) || 0;
            const offY = parseInt(document.getElementById('offsetY').value) || 0;

            // Draw Grid
            ctx.lineWidth = 1;
            ctx.strokeStyle = 'rgba(255, 0, 0, 0.5)'; // Red Grid

            const cols = Math.floor((img.width - offX) / stride);
            const rows = Math.floor((img.height - offY) / stride);

            for (let y = 0; y < rows; y++) {
                for (let x = 0; x < cols; x++) {
                    const gx = offX + (x * stride);
                    const gy = offY + (y * stride);
                    ctx.strokeRect(gx, gy, tileSize, tileSize);
                }
            }

            // Draw Cell 0 Highlight
            // Blue Box for the first tile
            ctx.fillStyle = 'rgba(0, 100, 255, 0.5)';
            ctx.fillRect(offX, offY, tileSize, tileSize);

            ctx.lineWidth = 2;
            ctx.strokeStyle = '#00ffff'; // Cyan Border for Cell 0
            ctx.strokeRect(offX, offY, tileSize, tileSize);
        }
    </script>
</body>

</html>